<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fitness Planner</title>

  <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html, body {
      height: 100%;
      overflow: hidden;
    }
    body {
      background: black;
      color: white;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", sans-serif;
      overscroll-behavior: none;
    }

    .soft-border {
      border: 1px solid rgba(255, 255, 255, 0.08);
    }

    .glass-nav {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
    }
  </style>
</head>

<body>
  <div id="root"></div>

  <script type="text/babel">
    const WEEK_DAYS = ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"];

    function getTodayNames() {
      const now = new Date();
      const todayIndex = (now.getDay() + 6) % 7; // Mon=0 ... Sun=6
      const tomorrowIndex = (todayIndex + 1) % 7;
      return {
        todayName: WEEK_DAYS[todayIndex],
        tomorrowName: WEEK_DAYS[tomorrowIndex],
      };
    }

    function getCurrentMonth() {
      const now = new Date();
      const year = now.getFullYear();
      const month = now.getMonth();
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);

      const days = [];
      for (let d = 1; d <= lastDay.getDate(); d++) {
        const date = new Date(year, month, d);
        days.push({
          date,
          key: `${year}-${month + 1}-${d}`,
        });
      }

      return {
        year,
        month,
        label: now.toLocaleString("default", { month: "long", year: "numeric" }),
        days,
      };
    }

    function App() {
      /* -------------------------
         NAVIGATION
      -------------------------- */
      const [tab, setTab] = React.useState("home");

      /* -------------------------
         GYM ROUTINES
      -------------------------- */
      const [routines, setRoutines] = React.useState(() => {
        const saved = localStorage.getItem("routines_v1");
        return saved ? JSON.parse(saved) : [];
      });

      const saveRoutines = (updated) => {
        setRoutines(updated);
        localStorage.setItem("routines_v1", JSON.stringify(updated));
      };

      /* -------------------------
         WEEKLY GYM PLAN
      -------------------------- */
      const [weeklyPlan, setWeeklyPlan] = React.useState(() => {
        const saved = localStorage.getItem("weeklyPlan_v1");
        return saved
          ? JSON.parse(saved)
          : {
              Mon: null,
              Tue: null,
              Wed: null,
              Thu: null,
              Fri: null,
              Sat: null,
              Sun: null,
            };
      });

      const saveWeeklyPlan = (updated) => {
        setWeeklyPlan(updated);
        localStorage.setItem("weeklyPlan_v1", JSON.stringify(updated));
      };

      /* -------------------------
         RUNNING WEEKLY PLAN + ROUTINES
      -------------------------- */
      const [runPlan, setRunPlan] = React.useState(() => {
        const saved = localStorage.getItem("runPlan_v1");
        return saved
          ? JSON.parse(saved)
          : {
              Mon: null,
              Tue: null,
              Wed: null,
              Thu: null,
              Fri: null,
              Sat: null,
              Sun: null,
            };
      });

      const saveRunPlan = (updated) => {
        setRunPlan(updated);
        localStorage.setItem("runPlan_v1", JSON.stringify(updated));
      };

      const [runRoutines, setRunRoutines] = React.useState(() => {
        const saved = localStorage.getItem("runRoutines_v1");
        return saved ? JSON.parse(saved) : [];
      });

      const saveRunRoutines = (updated) => {
        setRunRoutines(updated);
        localStorage.setItem("runRoutines_v1", JSON.stringify(updated));
      };

      /* -------------------------
         MODAL STATE
      -------------------------- */
      const [showGymCreator, setShowGymCreator] = React.useState(false);
      const [assigningDay, setAssigningDay] = React.useState(null);

      const [showRunCreator, setShowRunCreator] = React.useState(false);
      const [assigningRunDay, setAssigningRunDay] = React.useState(null);

      const [showCreateChooser, setShowCreateChooser] = React.useState(false);

      const [selectedDay, setSelectedDay] = React.useState(null);

      /* -------------------------
         GYM CREATOR FORM
      -------------------------- */
      const [newRoutineName, setNewRoutineName] = React.useState("");
      const [newExerciseName, setNewExerciseName] = React.useState("");
      const [newExerciseSets, setNewExerciseSets] = React.useState("");
      const [newExerciseReps, setNewExerciseReps] = React.useState("");
      const [tempExercises, setTempExercises] = React.useState([]);

      const addTempExercise = () => {
        if (!newExerciseName || !newExerciseSets || !newExerciseReps) return;
        setTempExercises([
          ...tempExercises,
          {
            name: newExerciseName,
            sets: Number(newExerciseSets),
            reps: Number(newExerciseReps),
          },
        ]);
        setNewExerciseName("");
        setNewExerciseSets("");
        setNewExerciseReps("");
      };

      const saveNewRoutine = () => {
        if (!newRoutineName || tempExercises.length === 0) return;
        const updated = [
          ...routines,
          {
            name: newRoutineName,
            exercises: tempExercises,
          },
        ];
        saveRoutines(updated);
        setNewRoutineName("");
        setTempExercises([]);
        setShowGymCreator(false);
      };

      /* -------------------------
         RUN CREATOR FORM
      -------------------------- */
      const [newRunType, setNewRunType] = React.useState("");
      const [newRunDistance, setNewRunDistance] = React.useState("");
      const [newRunPace, setNewRunPace] = React.useState("");

      const saveNewRunRoutine = () => {
        if (!newRunType || !newRunDistance || !newRunPace) return;
        const routine = {
          type: newRunType,
          distance: Number(newRunDistance),
          pace: newRunPace,
        };
        const updated = [...runRoutines, routine];
        saveRunRoutines(updated);
        setNewRunType("");
        setNewRunDistance("");
        setNewRunPace("");
        setShowRunCreator(false);
      };

      /* -------------------------
         DAY DETAILS PANEL
      -------------------------- */
      function openDayDetails(dayObj) {
        setSelectedDay(dayObj);
      }

      function closeDayDetails() {
        setSelectedDay(null);
      }

      /* -------------------------
         CALENDAR (SINGLE MONTH)
      -------------------------- */
      const currentMonth = getCurrentMonth();

      function renderDots(dateKey) {
        const d = new Date(dateKey);
        const weekdayIndex = d.getDay() === 0 ? 6 : d.getDay() - 1;
        const weekday = WEEK_DAYS[weekdayIndex];

        const gym = weeklyPlan[weekday];
        const run = runPlan[weekday];

        if (gym && run) {
          return (
            <div className="flex justify-center mt-1">
              <div className="w-2 h-2 rounded-full bg-white"></div>
            </div>
          );
        }

        if (gym) {
          return (
            <div className="flex justify-center mt-1">
              <div className="w-2 h-2 rounded-full bg-green-400"></div>
            </div>
          );
        }

        if (run) {
          return (
            <div className="flex justify-center mt-1">
              <div className="w-2 h-2 rounded-full bg-blue-400"></div>
            </div>
          );
        }

        return null;
      }

      /* -------------------------
         TODAY / TOMORROW NAMES
      -------------------------- */
      const { todayName, tomorrowName } = getTodayNames();

      /* -------------------------
         HOME TAB
      -------------------------- */
      const HomeTab = (
        <div className="w-full h-screen overflow-y-auto bg-black pb-32 px-4 pt-6">
          {/* TODAY */}
          <h2 className="text-xl font-semibold mb-2">Today‚Äôs Run</h2>
          {runPlan[todayName] ? (
            <div className="bg-[#1C1C1E] p-4 rounded-xl mb-6">
              <p className="font-semibold">{runPlan[todayName].type}</p>
              <p className="text-sm text-[#8E8E93]">
                {runPlan[todayName].distance} km ‚Äî {runPlan[todayName].pace}
              </p>
            </div>
          ) : (
            <p className="text-[#8E8E93] mb-6">No run today</p>
          )}

          <h2 className="text-xl font-semibold mb-2">Today‚Äôs Workout</h2>
          {weeklyPlan[todayName] ? (
            <div className="bg-[#1C1C1E] p-4 rounded-xl mb-6">
              <p className="font-semibold">{weeklyPlan[todayName].name}</p>
            </div>
          ) : (
            <p className="text-[#8E8E93] mb-6">No workout today</p>
          )}

          {/* TOMORROW */}
          <h2 className="text-xl font-semibold mb-2">Tomorrow‚Äôs Run</h2>
          {runPlan[tomorrowName] ? (
            <div className="bg-[#1C1C1E] p-4 rounded-xl mb-6">
              <p className="font-semibold">{runPlan[tomorrowName].type}</p>
              <p className="text-sm text-[#8E8E93]">
                {runPlan[tomorrowName].distance} km ‚Äî {runPlan[tomorrowName].pace}
              </p>
            </div>
          ) : (
            <p className="text-[#8E8E93] mb-6">No run tomorrow</p>
          )}

          <h2 className="text-xl font-semibold mb-2">Tomorrow‚Äôs Workout</h2>
          {weeklyPlan[tomorrowName] ? (
            <div className="bg-[#1C1C1E] p-4 rounded-xl mb-6">
              <p className="font-semibold">{weeklyPlan[tomorrowName].name}</p>
            </div>
          ) : (
            <p className="text-[#8E8E93] mb-6">No workout tomorrow</p>
          )}
        </div>
      );

      /* -------------------------
   CALENDAR TAB (TWO MONTHS)
-------------------------- */
const CalendarTab = (
  <div className="w-full h-screen overflow-y-auto bg-black pb-32 px-4 pt-6">

    {/* Generate current + next month */}
    {[0, 1].map((offset) => {
      const base = new Date();
      const year = base.getFullYear();
      const month = base.getMonth() + offset;

      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);

      const label = firstDay.toLocaleString("default", {
        month: "long",
        year: "numeric",
      });

      const days = [];
      for (let d = 1; d <= lastDay.getDate(); d++) {
        const date = new Date(year, month, d);
        days.push({
          date,
          key: `${year}-${month + 1}-${d}`,
        });
      }

      return (
        <div key={offset} className="mb-10">

          {/* Month Header */}
          <div className="text-2xl font-semibold tracking-tight mb-4">
            {label}
          </div>

          {/* Weekday Labels */}
          <div className="grid grid-cols-7 gap-2 text-center text-sm text-[#8E8E93]">
            {["M", "T", "W", "T", "F", "S", "S"].map((d, i) => (
              <div key={i}>{d}</div>
            ))}
          </div>

          {/* Month Grid */}
          <div className="grid grid-cols-7 gap-2 mt-2 text-center">
            {days.map((d) => {
              const isToday =
                new Date().toDateString() === d.date.toDateString();

              return (
                <button
                  key={d.key}
                  onClick={() => openDayDetails(d)}
                  className={`py-2 rounded-xl ${
                    isToday
                      ? "bg-white text-black font-semibold"
                      : "bg-[#1C1C1E]"
                  }`}
                >
                  {d.date.getDate()}
                  {renderDots(d.key)}
                </button>
              );
            })}
          </div>

        </div>
      );
    })}

    {/* DAY DETAILS PANEL (unchanged) */}
    {selectedDay && (
      <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
        <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">

          <div className="flex justify-between items-center mb-4">
            <h2 className="text-xl font-semibold">
              {selectedDay.date.toDateString()}
            </h2>
            <button
              onClick={closeDayDetails}
              className="text-sm text-[#8E8E93]"
            >
              Close
            </button>
          </div>

          {/* RUNNING ROUTINE */}
          {(() => {
            const weekdayIndex =
              selectedDay.date.getDay() === 0
                ? 6
                : selectedDay.date.getDay() - 1;
            const weekday = WEEK_DAYS[weekdayIndex];
            const routine = runPlan[weekday];

            if (!routine) {
              return (
                <p className="text-sm text-[#8E8E93] mb-4">
                  No running routine
                </p>
              );
            }

            return (
              <div className="mb-4">
                <p className="text-blue-400 text-sm font-semibold mb-1">
                  Run: {routine.type}
                </p>
                <p className="text-sm text-[#8E8E93]">
                  {routine.distance} km ‚Äî {routine.pace}
                </p>
              </div>
            );
          })()}

          {/* GYM ROUTINE */}
          {(() => {
            const weekdayIndex =
              selectedDay.date.getDay() === 0
                ? 6
                : selectedDay.date.getDay() - 1;
            const weekday = WEEK_DAYS[weekdayIndex];
            const routine = weeklyPlan[weekday];

            if (!routine) {
              return (
                <p className="text-sm text-[#8E8E93] mb-4">
                  No gym routine
                </p>
              );
            }

            return (
              <div className="mb-4">
                <p className="text-green-400 text-sm font-semibold mb-2">
                  Gym: {routine.name}
                </p>
                <ul className="text-sm text-[#8E8E93] space-y-1">
                  {routine.exercises.map((ex, i) => (
                    <li key={i}>
                      {ex.name} ‚Äî {ex.sets}√ó{ex.reps}
                    </li>
                  ))}
                </ul>
              </div>
            );
          })()}

          {/* ASSIGN WORKOUT */}
          <button
            onClick={() => {
              const weekdayIndex =
                selectedDay.date.getDay() === 0
                  ? 6
                  : selectedDay.date.getDay() - 1;
              const weekday = WEEK_DAYS[weekdayIndex];
              setAssigningDay(weekday);
            }}
            className="w-full bg-white text-black rounded-xl py-3 font-semibold mt-2"
          >
            Assign Workout to This Day
          </button>

          {/* ASSIGN RUN */}
          <button
            onClick={() => {
              const weekdayIndex =
                selectedDay.date.getDay() === 0
                  ? 6
                  : selectedDay.date.getDay() - 1;
              const weekday = WEEK_DAYS[weekdayIndex];
              setAssigningRunDay(weekday);
            }}
            className="w-full bg-white text-black rounded-xl py-3 font-semibold mt-3"
          >
            Assign Run to This Day
          </button>

        </div>
      </div>
    )}

  </div>
);

      /* -------------------------
         MODALS
      -------------------------- */

      // CREATE GYM ROUTINE
      const GymCreatorModal = showGymCreator && (
        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
          <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">
            <h2 className="text-xl font-semibold mb-4">Create Workout</h2>

            <input
              type="text"
              placeholder="Routine name"
              className="w-full mb-3 p-3 rounded-xl bg-[#2C2C2E]"
              value={newRoutineName}
              onChange={(e) => setNewRoutineName(e.target.value)}
            />

            <div className="mb-3">
              <div className="flex gap-2 mb-2">
                <input
                  type="text"
                  placeholder="Exercise"
                  className="flex-1 p-3 rounded-xl bg-[#2C2C2E]"
                  value={newExerciseName}
                  onChange={(e) => setNewExerciseName(e.target.value)}
                />
                <input
                  type="number"
                  placeholder="Sets"
                  className="w-20 p-3 rounded-xl bg-[#2C2C2E]"
                  value={newExerciseSets}
                  onChange={(e) => setNewExerciseSets(e.target.value)}
                />
                <input
                  type="number"
                  placeholder="Reps"
                  className="w-20 p-3 rounded-xl bg-[#2C2C2E]"
                  value={newExerciseReps}
                  onChange={(e) => setNewExerciseReps(e.target.value)}
                />
              </div>
              <button
                onClick={addTempExercise}
                className="w-full bg-white text-black rounded-xl py-2 text-sm font-semibold"
              >
                Add Exercise
              </button>
            </div>

            {tempExercises.length > 0 && (
              <div className="mb-4">
                <p className="text-sm text-[#8E8E93] mb-1">Exercises:</p>
                <ul className="text-sm text-[#E5E5EA] space-y-1">
                  {tempExercises.map((ex, i) => (
                    <li key={i}>
                      {ex.name} ‚Äî {ex.sets}√ó{ex.reps}
                    </li>
                  ))}
                </ul>
              </div>
            )}

            <button
              onClick={saveNewRoutine}
              className="w-full bg-white text-black rounded-xl py-3 font-semibold mt-2"
            >
              Save Workout
            </button>

            <button
              onClick={() => {
                setShowGymCreator(false);
                setTempExercises([]);
              }}
              className="w-full text-[#8E8E93] mt-3"
            >
              Cancel
            </button>
          </div>
        </div>
      );

      // ASSIGN WORKOUT TO DAY
      const AssignWorkoutModal = assigningDay && (
        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
          <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">
            <h2 className="text-xl font-semibold mb-4">
              Assign Workout to {assigningDay}
            </h2>

            {routines.length === 0 && (
              <p className="text-[#8E8E93] mb-4">No workouts created yet.</p>
            )}

            {routines.map((routine, i) => (
              <button
                key={i}
                onClick={() => {
                  const updated = {
                    ...weeklyPlan,
                    [assigningDay]: routine,
                  };
                  saveWeeklyPlan(updated);
                  setAssigningDay(null);
                }}
                className="w-full bg-[#2C2C2E] rounded-xl p-4 mb-3 text-left"
              >
                <p className="font-semibold">{routine.name}</p>
                <p className="text-sm text-[#8E8E93]">
                  {routine.exercises.length} exercises
                </p>
              </button>
            ))}

            <button
              onClick={() => setAssigningDay(null)}
              className="w-full text-[#8E8E93] mt-3"
            >
              Cancel
            </button>
          </div>
        </div>
      );

      // CREATE RUNNING ROUTINE
      const RunCreatorModal = showRunCreator && (
        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
          <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">
            <h2 className="text-xl font-semibold mb-4">Create Running Routine</h2>

            <input
              type="text"
              placeholder="Type (e.g., Tempo, Easy, Long)"
              className="w-full mb-3 p-3 rounded-xl bg-[#2C2C2E]"
              value={newRunType}
              onChange={(e) => setNewRunType(e.target.value)}
            />

            <input
              type="number"
              placeholder="Distance (km)"
              className="w-full mb-3 p-3 rounded-xl bg-[#2C2C2E]"
              value={newRunDistance}
              onChange={(e) => setNewRunDistance(e.target.value)}
            />

            <input
              type="text"
              placeholder="Pace (e.g., 5:00/km)"
              className="w-full mb-3 p-3 rounded-xl bg-[#2C2C2E]"
              value={newRunPace}
              onChange={(e) => setNewRunPace(e.target.value)}
            />

            <button
              onClick={saveNewRunRoutine}
              className="w-full bg-white text-black rounded-xl py-3 font-semibold mt-2"
            >
              Save Running Routine
            </button>

            <button
              onClick={() => setShowRunCreator(false)}
              className="w-full text-[#8E8E93] mt-3"
            >
              Cancel
            </button>
          </div>
        </div>
      );

      // ASSIGN RUN TO DAY
      const AssignRunModal = assigningRunDay && (
        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
          <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">
            <h2 className="text-xl font-semibold mb-4">
              Assign Run to {assigningRunDay}
            </h2>

            {runRoutines.length === 0 && (
              <p className="text-[#8E8E93] mb-4">No running routines created yet.</p>
            )}

            {runRoutines.map((routine, i) => (
              <button
                key={i}
                onClick={() => {
                  const updated = {
                    ...runPlan,
                    [assigningRunDay]: routine,
                  };
                  saveRunPlan(updated);
                  setAssigningRunDay(null);
                }}
                className="w-full bg-[#2C2C2E] rounded-xl p-4 mb-3 text-left"
              >
                <p className="font-semibold">{routine.type}</p>
                <p className="text-sm text-[#8E8E93]">
                  {routine.distance} km ‚Äî {routine.pace}
                </p>
              </button>
            ))}

            <button
              onClick={() => setAssigningRunDay(null)}
              className="w-full text-[#8E8E93] mt-3"
            >
              Cancel
            </button>
          </div>
        </div>
      );

      // + CHOOSER MODAL
      const CreateChooserModal = showCreateChooser && (
        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-end z-[999]">
          <div className="w-full bg-[#1C1C1E] rounded-t-3xl p-6 soft-border">
            <h2 className="text-xl font-semibold mb-4">Create</h2>

            <button
              onClick={() => {
                setShowCreateChooser(false);
                setShowGymCreator(true);
              }}
              className="w-full bg-[#2C2C2E] rounded-xl p-4 mb-3 text-left"
            >
              <p className="font-semibold">Gym Routine</p>
              <p className="text-sm text-[#8E8E93]">
                Build a strength workout with exercises
              </p>
            </button>

            <button
              onClick={() => {
                setShowCreateChooser(false);
                setShowRunCreator(true);
              }}
              className="w-full bg-[#2C2C2E] rounded-xl p-4 mb-3 text-left"
            >
              <p className="font-semibold">Running Routine</p>
              <p className="text-sm text-[#8E8E93]">
                Plan a structured run with distance and pace
              </p>
            </button>

            <button
              onClick={() => setShowCreateChooser(false)}
              className="w-full text-[#8E8E93] mt-3"
            >
              Cancel
            </button>
          </div>
        </div>
      );

     /* -------------------------
   RENDER
-------------------------- */
return (
  <div className="w-full h-screen relative overflow-hidden">

    {/* MAIN CONTENT */}
    {tab === "home" && HomeTab}
    {tab === "calendar" && CalendarTab}

    {/* BOTTOM NAV (with integrated + button) */}
    <div className="fixed bottom-4 left-0 right-0 flex justify-center z-[50]">
      <div className="glass-nav soft-border rounded-[24px] py-2.5 px-8 flex items-center justify-between w-[300px]">

        {/* Home */}
        <button
          onClick={() => setTab("home")}
          className={`flex flex-col items-center text-xs ${
            tab === "home" ? "text-white" : "text-[#8E8E93]"
          }`}
        >
          <span className="mb-1">üè†</span>
          <span>Home</span>
        </button>

        {/* Add Button (INTEGRATED) */}
        <button
          onClick={() => setShowCreateChooser(true)}
          className="w-12 h-12 rounded-full bg-white text-black flex items-center justify-center text-3xl font-semibold shadow-lg"
        >
          +
        </button>

        {/* Calendar */}
        <button
          onClick={() => setTab("calendar")}
          className={`flex flex-col items-center text-xs ${
            tab === "calendar" ? "text-white" : "text-[#8E8E93]"
          }`}
        >
          <span className="mb-1">üìÖ</span>
          <span>Calendar</span>
        </button>

      </div>
    </div>

    {/* MODALS */}
    {GymCreatorModal}
    {AssignWorkoutModal}
    {RunCreatorModal}
    {AssignRunModal}
    {CreateChooserModal}

  </div>
);

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
